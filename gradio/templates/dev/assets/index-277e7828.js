import{SvelteComponentDev as K,init as Q,safe_not_equal as W,dispatch_dev as k,validate_slots as Z,onMount as z,createEventDispatcher as X,tick as N,create_component as P,space as F,empty as he,mount_component as C,insert_dev as S,group_outros as _e,transition_out as y,check_outros as ge,transition_in as E,detach_dev as j,destroy_component as D,binding_callbacks as x,bind as be,create_slot as ve,element as Y,attr_dev as q,add_location as J,append_dev as V,noop as $,add_flush_callback as pe,update_slot_base as Me,get_all_dirty_from_scope as ye,get_slot_changes as Ee,assign as Ie,get_spread_update as ke,get_spread_object as Pe}from"../../../node/dev/svelte-internal.js";import{S as ee,X as Ce}from"./index-0c627992.js";import{B as oe,n as G}from"./Button-9bfe2272.js";import{U as te}from"./UploadText-6d1bc184.js";import{U as ne}from"./Upload-29fdce3c.js";import{M as re}from"./ModifyUpload-33dea6b2.js";import{B as le}from"./BlockLabel-f45b05bb.js";import{F as se}from"./File-38eadb9c.js";import{b as De,a as B,B as Ue,c as Be}from"./babylonjs.loaders.min-e2f1162a.js";import"./IconButton-559a7ff4.js";const H="Users/peterallen/Projects/gradio/js/model3D/interactive/Model3DUpload.svelte";function ie(t){let e,o,l,a,s;o=new re({props:{absolute:!0},$$inline:!0}),o.$on("clear",t[7]);const c={c:function(){e=Y("div"),P(o.$$.fragment),l=F(),a=Y("canvas"),q(a,"class","svelte-1nx6yyn"),J(a,H,123,2,2542),q(e,"class","input-model svelte-1nx6yyn"),J(e,H,121,1,2462)},m:function(r,d){S(r,e,d),C(o,e,null),V(e,l),V(e,a),t[14](a),s=!0},p:$,i:function(r){s||(E(o.$$.fragment,r),s=!0)},o:function(r){y(o.$$.fragment,r),s=!1},d:function(r){r&&j(e),D(o),t[14](null)}};return k("SvelteRegisterBlock",{block:c,id:ie.name,type:"else",source:"(87:0) {:else}",ctx:t}),c}function ce(t){let e,o,l;function a(u){t[13](u)}let s={root:t[3],filetype:".obj, .gltf, .glb",$$slots:{default:[ae]},$$scope:{ctx:t}};t[4]!==void 0&&(s.dragging=t[4]),e=new ne({props:s,$$inline:!0}),x.push(()=>be(e,"dragging",a)),e.$on("load",t[6]);const c={c:function(){P(e.$$.fragment)},m:function(r,d){C(e,r,d),l=!0},p:function(r,d){const m={};d&8&&(m.root=r[3]),d&32768&&(m.$$scope={dirty:d,ctx:r}),!o&&d&16&&(o=!0,m.dragging=r[4],pe(()=>o=!1)),e.$set(m)},i:function(r){l||(E(e.$$.fragment,r),l=!0)},o:function(r){y(e.$$.fragment,r),l=!1},d:function(r){D(e,r)}};return k("SvelteRegisterBlock",{block:c,id:ce.name,type:"if",source:"(83:0) {#if value === null}",ctx:t}),c}function ae(t){let e;const o=t[12].default,l=ve(o,t,t[15],null),a={c:function(){l&&l.c()},m:function(c,u){l&&l.m(c,u),e=!0},p:function(c,u){l&&l.p&&(!e||u&32768)&&Me(l,o,c,c[15],e?Ee(o,c[15],u,null):ye(c[15]),null)},i:function(c){e||(E(l,c),e=!0)},o:function(c){y(l,c),e=!1},d:function(c){l&&l.d(c)}};return k("SvelteRegisterBlock",{block:a,id:ae.name,type:"slot",source:'(84:1) <Upload on:load={handle_upload} {root} filetype=\\".obj, .gltf, .glb\\" bind:dragging>',ctx:t}),a}function T(t){let e,o,l,a,s,c;e=new le({props:{show_label:t[2],Icon:se,label:t[1]||"3D Model"},$$inline:!0});const u=[ce,ie],r=[];function d(w,f){return w[0]===null?0:1}l=d(t),a=r[l]=u[l](t);const m={c:function(){P(e.$$.fragment),o=F(),a.c(),s=he()},l:function(f){throw new Error("options.hydrate only works if the component was compiled with the `hydratable: true` option")},m:function(f,h){C(e,f,h),S(f,o,h),r[l].m(f,h),S(f,s,h),c=!0},p:function(f,[h]){const v={};h&4&&(v.show_label=f[2]),h&2&&(v.label=f[1]||"3D Model"),e.$set(v);let p=l;l=d(f),l===p?r[l].p(f,h):(_e(),y(r[p],1,1,()=>{r[p]=null}),ge(),a=r[l],a?a.p(f,h):(a=r[l]=u[l](f),a.c()),E(a,1),a.m(s.parentNode,s))},i:function(f){c||(E(e.$$.fragment,f),E(a),c=!0)},o:function(f){y(e.$$.fragment,f),y(a),c=!1},d:function(f){f&&(j(o),j(s)),D(e,f),r[l].d(f)}};return k("SvelteRegisterBlock",{block:m,id:T.name,type:"component",source:"",ctx:t}),m}function Se(t,e,o){let l,a,s,{$$slots:c={},$$scope:u}=e;Z("Model3DUpload",c,["default"]);let{value:r}=e,{clearColor:d=[0,0,0,0]}=e,{label:m=""}=e,{show_label:w}=e,{root:f}=e,h=!1;z(()=>{r!=null&&U(),o(9,h=!0)});async function v({detail:i}){o(0,r=i),await N(),I("change",r),U()}async function p(){_&&b&&(_.dispose(),b.dispose()),o(0,r=null),await N(),I("clear")}const I=X();let M=!1;De.OBJFileLoader.IMPORT_VERTEX_COLORS=!0;let g,_,b;function U(){if(_&&!_.isDisposed&&b&&(_.dispose(),b.dispose()),b=new B.Engine(g,!0),_=new B.Scene(b),_.createDefaultCameraOrLight(),_.clearColor=_.clearColor=new B.Color4(...d),b.runRenderLoop(()=>{_.render()}),window.addEventListener("resize",()=>{b.resize()}),!r)return;let i;if(r.is_file)i=r.data;else{let n=r.data,me=B.Tools.DecodeBase64(n),we=new Blob([me]);i=URL.createObjectURL(we)}B.SceneLoader.ShowLoadingScreen=!1,B.SceneLoader.Append(i,"",_,()=>{_.createDefaultCamera(!0,!0,!0)},void 0,void 0,"."+r.name.split(".")[1])}t.$$.on_mount.push(function(){r===void 0&&!("value"in e||t.$$.bound[t.$$.props.value])&&console.warn("<Model3DUpload> was created without expected prop 'value'"),w===void 0&&!("show_label"in e||t.$$.bound[t.$$.props.show_label])&&console.warn("<Model3DUpload> was created without expected prop 'show_label'"),f===void 0&&!("root"in e||t.$$.bound[t.$$.props.root])&&console.warn("<Model3DUpload> was created without expected prop 'root'")});const R=["value","clearColor","label","show_label","root"];Object.keys(e).forEach(i=>{!~R.indexOf(i)&&i.slice(0,2)!=="$$"&&i!=="slot"&&console.warn(`<Model3DUpload> was created with unknown prop '${i}'`)});function L(i){M=i,o(4,M)}function O(i){x[i?"unshift":"push"](()=>{g=i,o(5,g)})}return t.$$set=i=>{"value"in i&&o(0,r=i.value),"clearColor"in i&&o(8,d=i.clearColor),"label"in i&&o(1,m=i.label),"show_label"in i&&o(2,w=i.show_label),"root"in i&&o(3,f=i.root),"$$scope"in i&&o(15,u=i.$$scope)},t.$capture_state=()=>({createEventDispatcher:X,tick:N,onMount:z,Upload:ne,ModifyUpload:re,BlockLabel:le,File:se,value:r,clearColor:d,label:m,show_label:w,root:f,mounted:h,handle_upload:v,handle_clear:p,dispatch:I,dragging:M,BABYLON:Ue,BABYLON_LOADERS:Be,canvas:g,scene:_,engine:b,addNewModel:U,is_file:a,data:l,name:s}),t.$inject_state=i=>{"value"in i&&o(0,r=i.value),"clearColor"in i&&o(8,d=i.clearColor),"label"in i&&o(1,m=i.label),"show_label"in i&&o(2,w=i.show_label),"root"in i&&o(3,f=i.root),"mounted"in i&&o(9,h=i.mounted),"dragging"in i&&o(4,M=i.dragging),"canvas"in i&&o(5,g=i.canvas),"scene"in i&&(_=i.scene),"engine"in i&&(b=i.engine),"is_file"in i&&o(10,a=i.is_file),"data"in i&&o(11,l=i.data),"name"in i&&(s=i.name)},e&&"$$inject"in e&&t.$inject_state(e.$$inject),t.$$.update=()=>{t.$$.dirty&1&&o(11,{data:l,is_file:a,name:s}=r||{data:void 0,is_file:void 0,name:void 0},l,(o(10,a),o(0,r))),t.$$.dirty&3616&&g&&h&&l!=null&&a&&U(),t.$$.dirty&16&&I("drag",M)},[r,m,w,f,M,g,v,p,d,h,a,l,c,L,O,u]}class de extends K{constructor(e){super(e),Q(this,e,Se,T,W,{value:0,clearColor:8,label:1,show_label:2,root:3}),k("SvelteRegisterComponent",{component:this,tagName:"Model3DUpload",options:e,id:T.name})}get value(){throw new Error("<Model3DUpload>: Props cannot be read directly from the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}set value(e){throw new Error("<Model3DUpload>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}get clearColor(){throw new Error("<Model3DUpload>: Props cannot be read directly from the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}set clearColor(e){throw new Error("<Model3DUpload>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}get label(){throw new Error("<Model3DUpload>: Props cannot be read directly from the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}set label(e){throw new Error("<Model3DUpload>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}get show_label(){throw new Error("<Model3DUpload>: Props cannot be read directly from the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}set show_label(e){throw new Error("<Model3DUpload>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}get root(){throw new Error("<Model3DUpload>: Props cannot be read directly from the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}set root(e){throw new Error("<Model3DUpload>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}}function ue(t){let e,o;e=new te({props:{type:"file"},$$inline:!0});const l={c:function(){P(e.$$.fragment)},m:function(s,c){C(e,s,c),o=!0},p:$,i:function(s){o||(E(e.$$.fragment,s),o=!0)},o:function(s){y(e.$$.fragment,s),o=!1},d:function(s){D(e,s)}};return k("SvelteRegisterBlock",{block:l,id:ue.name,type:"slot",source:'(38:1) <Model3DUpload   {label}   {show_label}   {clearColor}   {root}   value={_value}   on:change={({ detail }) => (value = detail)}   on:drag={({ detail }) => (dragging = detail)}   on:change={({ detail }) => gradio.dispatch(\\"change\\", detail)}   on:clear={() => gradio.dispatch(\\"clear\\")}  >',ctx:t}),l}function fe(t){let e,o,l,a;const s=[t[6]];let c={};for(let r=0;r<s.length;r+=1)c=Ie(c,s[r]);e=new ee({props:c,$$inline:!0}),l=new de({props:{label:t[7],show_label:t[8],clearColor:t[5],root:t[4],value:t[13],$$slots:{default:[ue]},$$scope:{ctx:t}},$$inline:!0}),l.$on("change",t[16]),l.$on("drag",t[17]),l.$on("change",t[18]),l.$on("clear",t[19]);const u={c:function(){P(e.$$.fragment),o=F(),P(l.$$.fragment)},m:function(d,m){C(e,d,m),S(d,o,m),C(l,d,m),a=!0},p:function(d,m){const w=m&64?ke(s,[Pe(d[6])]):{};e.$set(w);const f={};m&128&&(f.label=d[7]),m&256&&(f.show_label=d[8]),m&32&&(f.clearColor=d[5]),m&16&&(f.root=d[4]),m&8192&&(f.value=d[13]),m&1048576&&(f.$$scope={dirty:m,ctx:d}),l.$set(f)},i:function(d){a||(E(e.$$.fragment,d),E(l.$$.fragment,d),a=!0)},o:function(d){y(e.$$.fragment,d),y(l.$$.fragment,d),a=!1},d:function(d){d&&j(o),D(e,d),D(l,d)}};return k("SvelteRegisterBlock",{block:u,id:fe.name,type:"slot",source:'(25:0) <Block  {visible}  variant={value === null ? \\"dashed\\" : \\"solid\\"}  border_mode={dragging ? \\"focus\\" : \\"base\\"}  padding={false}  {elem_id}  {elem_classes}  {container}  {scale}  {min_width} >',ctx:t}),u}function A(t){let e,o;e=new oe({props:{visible:t[3],variant:t[0]===null?"dashed":"solid",border_mode:t[14]?"focus":"base",padding:!1,elem_id:t[1],elem_classes:t[2],container:t[9],scale:t[10],min_width:t[11],$$slots:{default:[fe]},$$scope:{ctx:t}},$$inline:!0});const l={c:function(){P(e.$$.fragment)},l:function(s){throw new Error("options.hydrate only works if the component was compiled with the `hydratable: true` option")},m:function(s,c){C(e,s,c),o=!0},p:function(s,[c]){const u={};c&8&&(u.visible=s[3]),c&1&&(u.variant=s[0]===null?"dashed":"solid"),c&16384&&(u.border_mode=s[14]?"focus":"base"),c&2&&(u.elem_id=s[1]),c&4&&(u.elem_classes=s[2]),c&512&&(u.container=s[9]),c&1024&&(u.scale=s[10]),c&2048&&(u.min_width=s[11]),c&1077745&&(u.$$scope={dirty:c,ctx:s}),e.$set(u)},i:function(s){o||(E(e.$$.fragment,s),o=!0)},o:function(s){y(e.$$.fragment,s),o=!1},d:function(s){D(e,s)}};return k("SvelteRegisterBlock",{block:l,id:A.name,type:"component",source:"",ctx:t}),l}function je(t,e,o){let{$$slots:l={},$$scope:a}=e;Z("InteractiveModel3d",l,[]);let{elem_id:s=""}=e,{elem_classes:c=[]}=e,{visible:u=!0}=e,{value:r=null}=e,{root:d}=e,{root_url:m}=e,{clearColor:w}=e,{loading_status:f}=e,{label:h}=e,{show_label:v}=e,{container:p=!0}=e,{scale:I=null}=e,{min_width:M=void 0}=e,{gradio:g}=e,_,b=!1;t.$$.on_mount.push(function(){d===void 0&&!("root"in e||t.$$.bound[t.$$.props.root])&&console.warn("<InteractiveModel3d> was created without expected prop 'root'"),m===void 0&&!("root_url"in e||t.$$.bound[t.$$.props.root_url])&&console.warn("<InteractiveModel3d> was created without expected prop 'root_url'"),w===void 0&&!("clearColor"in e||t.$$.bound[t.$$.props.clearColor])&&console.warn("<InteractiveModel3d> was created without expected prop 'clearColor'"),f===void 0&&!("loading_status"in e||t.$$.bound[t.$$.props.loading_status])&&console.warn("<InteractiveModel3d> was created without expected prop 'loading_status'"),h===void 0&&!("label"in e||t.$$.bound[t.$$.props.label])&&console.warn("<InteractiveModel3d> was created without expected prop 'label'"),v===void 0&&!("show_label"in e||t.$$.bound[t.$$.props.show_label])&&console.warn("<InteractiveModel3d> was created without expected prop 'show_label'"),g===void 0&&!("gradio"in e||t.$$.bound[t.$$.props.gradio])&&console.warn("<InteractiveModel3d> was created without expected prop 'gradio'")});const U=["elem_id","elem_classes","visible","value","root","root_url","clearColor","loading_status","label","show_label","container","scale","min_width","gradio"];Object.keys(e).forEach(n=>{!~U.indexOf(n)&&n.slice(0,2)!=="$$"&&n!=="slot"&&console.warn(`<InteractiveModel3d> was created with unknown prop '${n}'`)});const R=({detail:n})=>o(0,r=n),L=({detail:n})=>o(14,b=n),O=({detail:n})=>g.dispatch("change",n),i=()=>g.dispatch("clear");return t.$$set=n=>{"elem_id"in n&&o(1,s=n.elem_id),"elem_classes"in n&&o(2,c=n.elem_classes),"visible"in n&&o(3,u=n.visible),"value"in n&&o(0,r=n.value),"root"in n&&o(4,d=n.root),"root_url"in n&&o(15,m=n.root_url),"clearColor"in n&&o(5,w=n.clearColor),"loading_status"in n&&o(6,f=n.loading_status),"label"in n&&o(7,h=n.label),"show_label"in n&&o(8,v=n.show_label),"container"in n&&o(9,p=n.container),"scale"in n&&o(10,I=n.scale),"min_width"in n&&o(11,M=n.min_width),"gradio"in n&&o(12,g=n.gradio)},t.$capture_state=()=>({normalise_file:G,Model3DUpload:de,Block:oe,UploadText:te,StatusTracker:ee,_:Ce,elem_id:s,elem_classes:c,visible:u,value:r,root:d,root_url:m,clearColor:w,loading_status:f,label:h,show_label:v,container:p,scale:I,min_width:M,gradio:g,_value:_,dragging:b}),t.$inject_state=n=>{"elem_id"in n&&o(1,s=n.elem_id),"elem_classes"in n&&o(2,c=n.elem_classes),"visible"in n&&o(3,u=n.visible),"value"in n&&o(0,r=n.value),"root"in n&&o(4,d=n.root),"root_url"in n&&o(15,m=n.root_url),"clearColor"in n&&o(5,w=n.clearColor),"loading_status"in n&&o(6,f=n.loading_status),"label"in n&&o(7,h=n.label),"show_label"in n&&o(8,v=n.show_label),"container"in n&&o(9,p=n.container),"scale"in n&&o(10,I=n.scale),"min_width"in n&&o(11,M=n.min_width),"gradio"in n&&o(12,g=n.gradio),"_value"in n&&o(13,_=n._value),"dragging"in n&&o(14,b=n.dragging)},e&&"$$inject"in e&&t.$inject_state(e.$$inject),t.$$.update=()=>{t.$$.dirty&32785&&o(13,_=G(r,d,m))},[r,s,c,u,d,w,f,h,v,p,I,M,g,_,b,m,R,L,O,i]}class Re extends K{constructor(e){super(e),Q(this,e,je,A,W,{elem_id:1,elem_classes:2,visible:3,value:0,root:4,root_url:15,clearColor:5,loading_status:6,label:7,show_label:8,container:9,scale:10,min_width:11,gradio:12}),k("SvelteRegisterComponent",{component:this,tagName:"InteractiveModel3d",options:e,id:A.name})}get elem_id(){throw new Error("<InteractiveModel3d>: Props cannot be read directly from the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}set elem_id(e){throw new Error("<InteractiveModel3d>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}get elem_classes(){throw new Error("<InteractiveModel3d>: Props cannot be read directly from the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}set elem_classes(e){throw new Error("<InteractiveModel3d>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}get visible(){throw new Error("<InteractiveModel3d>: Props cannot be read directly from the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}set visible(e){throw new Error("<InteractiveModel3d>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}get value(){throw new Error("<InteractiveModel3d>: Props cannot be read directly from the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}set value(e){throw new Error("<InteractiveModel3d>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}get root(){throw new Error("<InteractiveModel3d>: Props cannot be read directly from the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}set root(e){throw new Error("<InteractiveModel3d>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}get root_url(){throw new Error("<InteractiveModel3d>: Props cannot be read directly from the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}set root_url(e){throw new Error("<InteractiveModel3d>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}get clearColor(){throw new Error("<InteractiveModel3d>: Props cannot be read directly from the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}set clearColor(e){throw new Error("<InteractiveModel3d>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}get loading_status(){throw new Error("<InteractiveModel3d>: Props cannot be read directly from the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}set loading_status(e){throw new Error("<InteractiveModel3d>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}get label(){throw new Error("<InteractiveModel3d>: Props cannot be read directly from the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}set label(e){throw new Error("<InteractiveModel3d>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}get show_label(){throw new Error("<InteractiveModel3d>: Props cannot be read directly from the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}set show_label(e){throw new Error("<InteractiveModel3d>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}get container(){throw new Error("<InteractiveModel3d>: Props cannot be read directly from the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}set container(e){throw new Error("<InteractiveModel3d>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}get scale(){throw new Error("<InteractiveModel3d>: Props cannot be read directly from the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}set scale(e){throw new Error("<InteractiveModel3d>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}get min_width(){throw new Error("<InteractiveModel3d>: Props cannot be read directly from the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}set min_width(e){throw new Error("<InteractiveModel3d>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}get gradio(){throw new Error("<InteractiveModel3d>: Props cannot be read directly from the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}set gradio(e){throw new Error("<InteractiveModel3d>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}}const Je=Re;export{Je as default};
//# sourceMappingURL=index-277e7828.js.map
